
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Integrated Project - Web Call Center</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#546d78">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/github.min.css">
    
      <link rel="stylesheet" href="../../extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="dark" data-md-color-primary="blue-grey" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#integrated-project" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Web Call Center" class="md-header__button md-logo" aria-label="Web Call Center" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 6V4h.1C12.9 4 20 11.1 20 19.9v.1h-2v-.1C18 12.2 11.8 6 4 6m0 4V8a12 12 0 0 1 12 12h-2A10 10 0 0 0 4 10m0 4v-2a8 8 0 0 1 8 8h-2a6 6 0 0 0-6-6m0 2a4 4 0 0 1 4 4H4v-4Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Web Call Center
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Integrated Project
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/grey-dev-0/web-call-center" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    grey-dev-0/web-call-center
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Web Call Center" class="md-nav__button md-logo" aria-label="Web Call Center" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 6V4h.1C12.9 4 20 11.1 20 19.9v.1h-2v-.1C18 12.2 11.8 6 4 6m0 4V8a12 12 0 0 1 12 12h-2A10 10 0 0 0 4 10m0 4v-2a8 8 0 0 1 8 8h-2a6 6 0 0 0-6-6m0 2a4 4 0 0 1 4 4H4v-4Z"/></svg>

    </a>
    Web Call Center
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/grey-dev-0/web-call-center" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    grey-dev-0/web-call-center
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Web Call Center for Laravel
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bare-project/" class="md-nav__link">
        Bare Project
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Integrated Project
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Integrated Project
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-installing-web-call-center" class="md-nav__link">
    1. Installing Web Call Center
  </a>
  
    <nav class="md-nav" aria-label="1. Installing Web Call Center">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1a-requiring-the-package" class="md-nav__link">
    1.a. Requiring the Package
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1b-publishing-assets" class="md-nav__link">
    1.b. Publishing Assets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1c-configuring-web-call-center" class="md-nav__link">
    1.c Configuring Web Call Center
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1d-database-setup" class="md-nav__link">
    1.d. Database Setup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-custom-eloquent-models" class="md-nav__link">
    2. Custom Eloquent Models
  </a>
  
    <nav class="md-nav" aria-label="2. Custom Eloquent Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2a-organization-model" class="md-nav__link">
    2.a. Organization Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2b-agent-model" class="md-nav__link">
    2.b. Agent Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2c-customer-model" class="md-nav__link">
    2.c. Customer Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2d-user-model" class="md-nav__link">
    2.d. User Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-integrating-agora" class="md-nav__link">
    3. Integrating Agora
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-integrating-laravel-websockets" class="md-nav__link">
    4. Integrating Laravel Websockets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-web-server-configuration" class="md-nav__link">
    5. Web Server Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-were-done-whats-next" class="md-nav__link">
    6. We're Done. What's Next!
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Third parties
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Third parties" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Third parties
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../third-parties/agora/" class="md-nav__link">
        Agora
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../third-parties/websocket/" class="md-nav__link">
        Laravel Websockets
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-installing-web-call-center" class="md-nav__link">
    1. Installing Web Call Center
  </a>
  
    <nav class="md-nav" aria-label="1. Installing Web Call Center">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1a-requiring-the-package" class="md-nav__link">
    1.a. Requiring the Package
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1b-publishing-assets" class="md-nav__link">
    1.b. Publishing Assets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1c-configuring-web-call-center" class="md-nav__link">
    1.c Configuring Web Call Center
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1d-database-setup" class="md-nav__link">
    1.d. Database Setup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-custom-eloquent-models" class="md-nav__link">
    2. Custom Eloquent Models
  </a>
  
    <nav class="md-nav" aria-label="2. Custom Eloquent Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2a-organization-model" class="md-nav__link">
    2.a. Organization Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2b-agent-model" class="md-nav__link">
    2.b. Agent Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2c-customer-model" class="md-nav__link">
    2.c. Customer Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2d-user-model" class="md-nav__link">
    2.d. User Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-integrating-agora" class="md-nav__link">
    3. Integrating Agora
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-integrating-laravel-websockets" class="md-nav__link">
    4. Integrating Laravel Websockets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-web-server-configuration" class="md-nav__link">
    5. Web Server Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-were-done-whats-next" class="md-nav__link">
    6. We're Done. What's Next!
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="integrated-project">Integrated Project</h1>
<h2 id="overview">Overview</h2>
<p>If you already have an existing Laravel project, you can easily integrate Web Call Center into it, you have the option to use all the database tables and models provided by the package or, customize it so that you can pick which of your own models represent any of the following entities:</p>
<ul>
<li><strong>Organization</strong> which represents the establishment that has one or more customer service agents.</li>
<li><strong>Agent</strong> which represents the customer service agent.</li>
<li><strong>Customer</strong> which represents the customer.</li>
</ul>
<p>So basically a <strong>customer</strong> would be calling an <strong>organization</strong> of their choice then, their call will automatically be assigned to the <strong>organization</strong>'s least occupied <strong>agent</strong> who's currently online, the incoming <strong>calls</strong> will be queued to the assigned <strong>agents</strong> accordingly, so they'd pick up and answer them as soon as possible in FIFO - first in first served - fashion.</p>
<p>The <strong>Call</strong> entity is the only fixed entity that it's not allowed to be customized or replaced at the moment however, it will automatically be associated with the other entities regardless whether you replace any of them with your own models, more on how to do that customization is explained below, anyway please follow the steps stated in this page to avoid any potential errors.</p>
<h2 id="1-installing-web-call-center">1. Installing Web Call Center</h2>
<p>This project is created as a package to be integrated with a Laravel application so, let's set it up by following the next steps.</p>
<h3 id="1a-requiring-the-package">1.a. Requiring the Package</h3>
<p>In the terminal at your project's root directory, please write the following.</p>
<pre class="highlight"><code class="language-shell">$ composer require grey-dev-0/web-call-center:@dev</code></pre>
<h3 id="1b-publishing-assets">1.b. Publishing Assets</h3>
<p>This step is necessary for publishing the configuration files that you'd update to customize the integration of Web Call Center to your Laravel project, besides it will publish Web Call Center's blade views, so that you can customize them to match your application's stying and UI and, finally required frontend assets are also published for UI to work.</p>
<pre class="highlight"><code class="language-shell">$ php artisan vendor:publish --force --provider='GreyZero\WebCallCenter\Providers\AppServiceProvider'</code></pre>
<h3 id="1c-configuring-web-call-center">1.c Configuring Web Call Center</h3>
<p>After publishing the assets you'll find the configuration file of Web Call Center located in your default configuration directory i.e. <code>config/web-call-center.php</code>, despite the clarity of comments written before each configuration setting let's have a quick look into the most ambiguous ones.</p>
<ul>
<li><code>middleware</code>: sets the default middleware to be used by the package and, <strong>implicitly</strong> sets the default authentication's users provider to the package's <code>User</code> model so, if you plan to authenticate your own users into Web Call Center please change it to <code>web</code> instead.</li>
<li><code>morph_authenticatable</code>: If set to <code>true</code> then the authentication entity must have a polymorphic relationship with <strong>Agent</strong> and <strong>Customer</strong> entities, otherwise it means that each <strong>Agent</strong> and <strong>Customer</strong> entities are authenticatable models on their own, <strong>note</strong> that this only to be changed if you set your custom <code>middleware</code> setting and, you'd authenticate agents and customers by their separate entities.</li>
<li><code>customer_model</code>, <code>agent_model</code> and, <code>organization_model</code> are the full model class names - including the namespace - that represent each entity, you may change any of them to the model class existing in your own Laravel application which represents that corresponding entity.</li>
<li><code>organization_foreign_key</code>: The foreign key that relates the <strong>Agent</strong> entity's table to the <strong>Organization</strong> entity's table, you'd need to change this accordingly if you customize either or both of <strong>Organization</strong> and <strong>Agent</strong> model classes mentioned in the previous point.</li>
<li><code>incremental_primary_key</code>: each table of the main three tables will have an incremental primary key by default, if you'd like to set the primary key manually for any created record of those tables, you can simply set the flag of that table to <code>false</code>, the purpose of setting it to <code>false</code> would be using the primary key as a foreign key that refers to another table or entity in your own Laravel application.</li>
</ul>
<h3 id="1d-database-setup">1.d. Database Setup</h3>
<p>In this step we'll run the database migration command to create the tables required by Web Call Center, provided that you've set the configuration settings that suit your project in the previous step, <strong>please note</strong> that this step is necessary even if you've designated your own models to all of the customizable models, as the <code>calls</code> table is required regardless and, needs to be created for the call center to function.</p>
<p>If you don't have Laravel queues feature enabled in your project, please enable it by setting <code>QUEUE_CONNECTION</code> variable to <code>database</code> in the <code>.env</code> file then, in terminal at your project's root directory you'll need to write:</p>
<pre class="highlight"><code class="language-shell">$ php artisan queue:table</code></pre>
<div class="admonition question">
<p class="admonition-title">What if queues are already enabled but on a connection other than <code>database</code> e.g. <code>redis</code>?</p>
<p>Skip the queues related part in this case but, you'll still need to proceed to the <code>migrate</code> command mentioned afterwards.</p>
</div>
<p>Then finally you'll need to run the following terminal command to run all required database migrations.</p>
<pre class="highlight"><code class="language-shell">$ php artisan migrate</code></pre>
<h2 id="2-custom-eloquent-models">2. Custom Eloquent Models</h2>
<p>If you have set your own model class for any of the major three entities <strong>Organization</strong>, <strong>Agent</strong> or, <strong>Customer</strong> please check the sections that correspond to your customized entities in this step.</p>
<p>Also if you have set custom <code>middleware</code> value, please check the <a href="#2-d-user-model">User Model section</a> as well.</p>
<h3 id="2a-organization-model">2.a. Organization Model</h3>
<p>If you have changed <code>organization_model</code> configuration setting in the <code>config/web-call-center.php</code> file to an existing model in your project that represents the <strong>Organization</strong> entity e.g. <code>\App\Models\SomeAgency::class</code> then, you'll need to use the <code>HasAgents</code> trait in that class so, the class would look like the following:</p>
<pre class="highlight"><code class="language-php">namespace App\Models;

use GreyZero\WebCallCenter\Traits\HasAgents;
use Illuminate\Database\Eloquent\Model;

class SomeAgency extends Model{
    use HasAgents;

    // ...
}</code></pre>
<h3 id="2b-agent-model">2.b. Agent Model</h3>
<p>If you have changed <code>agent_model</code> configuration setting in the <code>config/web-call-center.php</code> file to an existing model in your project that represents the <strong>Agent</strong> entity e.g. <code>\App\Models\SomeAgent::class</code> then, you'll need to use the <code>ReceivesCalls</code> trait in that class so, the class would look like the following:</p>
<pre class="highlight"><code class="language-php">namespace App\Models;

use GreyZero\WebCallCenter\Traits\ReceivesCalls;
use Illuminate\Database\Eloquent\Model;

class SomeAgent extends Model{
    use ReceivesCalls;

    // ...
}</code></pre>
<h3 id="2c-customer-model">2.c. Customer Model</h3>
<p>If you have changed <code>customer_model</code> configuration setting in the <code>config/web-call-center.php</code> file to an existing model in your project that represents the <strong>Customer</strong> entity e.g. <code>\App\Models\SomeCustomer::class</code> then, you'll need to use the <code>MakesCalls</code> trait in that class so, the class would look like the following:</p>
<pre class="highlight"><code class="language-php">namespace App\Models;

use GreyZero\WebCallCenter\Traits\MakesCalls;
use Illuminate\Database\Eloquent\Model;

class SomeCustomer extends Model{
    use MakesCalls;

    // ...
}</code></pre>
<h3 id="2d-user-model">2.d. User Model</h3>
<p>If you have changed the <code>middleware</code> configuration setting in the <code>config/web-call-center.php</code> file to <code>web</code> or any other middleware than the preset default, you'll need to use the <code>UsesCallCenter</code> trait in your authenticatable model(s), in case if you have one authentication model i.e. <code>morph_authenticatable</code> is set to <code>true</code> then, you'll use that trait in that model class, otherwise you'll need to use that trait with each authenticatable model; the one that represents the <strong>Agent</strong> and the one that represents the <strong>Customer</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Single Authentication Model</label><label for="__tabbed_1_2">Multiple Authentication Models</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><code>morph_authenticatable</code> is <code>true</code> in this case i.e. you're authenticating your users using the default <code>User</code> model provided by Laravel which is modified by you or, you might be using another model of your own that relates to <strong>Agent</strong> and <strong>Customer</strong> via a polymorphic relationship.</p>
<pre class="highlight"><code class="language-php">namespace App\Models;

use GreyZero\WebCallCenter\Traits\UsesCallCenter;
use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;
use Laravel\Sanctum\HasApiTokens;

class User extends Authenticatable{
    use HasApiTokens, HasFactory, Notifiable, UsesCallCenter;

    // ...
}</code></pre>
</div>
<div class="tabbed-block">
<p><code>morph_authenticatable</code> is <code>false</code> in this case i.e. you're authenticating your users using several models, so we need to define which of them are going to use Web Call Center besides, which of them will represent the <strong>Agent</strong> and which will represent the <strong>Customer</strong> so, the model that represents the <strong>Agent</strong> in your project should  look like the following:</p>
<pre class="highlight"><code class="language-php">namespace App\Models;

use GreyZero\WebCallCenter\Traits\ReceivesCalls;
use GreyZero\WebCallCenter\Traits\UsesCallCenter;
use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Laravel\Sanctum\HasApiTokens;

class SomeAgent extends Authenticatable{
    use HasApiTokens, HasFactory, ReceivesCalls, UsesCallCenter;

    // ...
}</code></pre>
<p>And the model that represents the <strong>Customer</strong> in your project should look like this:</p>
<pre class="highlight"><code class="language-php">namespace App\Models;

use GreyZero\WebCallCenter\Traits\MakesCalls;
use GreyZero\WebCallCenter\Traits\UsesCallCenter;
use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;
use Laravel\Sanctum\HasApiTokens;

class SomeCustomer extends Authenticatable{
    use HasApiTokens, HasFactory, MakesCalls, Notifiable, UsesCallCenter;

    // ...
}</code></pre>
</div>
</div>
</div>
<h2 id="3-integrating-agora">3. Integrating Agora</h2>
<!-- BEGIN INCLUDE ../../common/agora.md -->
<p>The package relies on <a href="https://agora.io/../../common">Agora IO</a> WebRTC services to implement the voice calls feature between customers and agents, the service provides a free plan that's a good starter for this project so, first you'll have to sign up to their service <a href="https://sso.agora.io/en/signup">here</a> or, if you already have an account you can directly use it.</p>
<p>For detailed steps on how to setup Agora in our project please refer to <a href="../../third-parties/agora/#enabling-agora-integration">Agora installation page</a>.</p>
<!-- END INCLUDE -->

<h2 id="4-integrating-laravel-websockets">4. Integrating Laravel Websockets</h2>
<!-- BEGIN INCLUDE ../../common/websocket.md -->
<p><a href="https://beyondco.de/docs/laravel-websockets/getting-started/introduction">Laravel Websockets</a> is a library used internally by this project that enables the server to monitor which customer support agents are currently online within each organization, so that incoming calls can only be assigned to online agents.</p>
<p>To set it up please refer to <a href="../../third-parties/websocket/#laravel-websockets-integration">Laravel Websockets installation page</a>.</p>
<!-- END INCLUDE -->

<h2 id="5-web-server-configuration">5. Web Server Configuration</h2>
<p>As seen in the previous step this project relies on Websockets to manage online customer service agents so, you'll need to ensure that websocket related settings are properly set in your web server configuration file.</p>
<!-- BEGIN INCLUDE ../../common/server.md -->
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Nginx</label><label for="__tabbed_2_2">Apache</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>If you don't have nginx configuration file for the project yet, please create one in <code>/etc/nginx/conf.d</code> directory, filename doesn't matter much as long as it ends with <code>.conf</code> extension, in that file whether you've just created it or you're editing an existing one please ensure it matches the following, replacing all <code>&lt;placeholder&gt;</code> values with your corresponding values:</p>
<pre class="highlight"><code class="language-nginx">server {
    listen       80;        # Disable this on Production server for security
    listen       [::]:80;   # Disable this too on Production
    listen       443 ssl;
    listen       [::]:443 ssl;
    server_name  &lt;your_domain&gt;;
    ssl_certificate /etc/nginx/ssl/certificate.pem;
    ssl_certificate_key /etc/nginx/ssl/key.pem;
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
    ssl_session_tickets off;
    ssl_stapling off;
    ssl_stapling_verify off;
    index index.php;
    root &lt;aboslute_path_to_project&gt;/public;

    location / {
        try_files $uri $uri/ /index.php$is_args$args;
    }

    location /app/&lt;app_key_in_env_file&gt; {
        proxy_pass http://127.0.0.1:6001;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_http_version 1.1;
        proxy_set_header Upgrade "websocket";
        proxy_set_header Connection "upgrade";
        proxy_read_timeout 30000s;
        proxy_send_timeout 30000s;
        proxy_redirect off;
        proxy_connect_timeout 30000s;
    }

    # Replace this with your php-fpm configuration block or correct configuration file.
    include common/php-fpm.conf;

    location ~ \.env$ {
        deny all;
    }
}</code></pre>
<div class="admonition info">
<p class="admonition-title">Notice</p>
<p>If you have changed the default websocket port with <code>LARAVEL_WEBSOCKETS_PORT</code> variable in the <code>.env</code> file, please replace the port <code>6001</code> in the nginx configuration above with the one you specified in the <code>.env</code> file accordingly.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">IMPORTANT</p>
<p>After saving the file you'll need to run the following command in terminal to use the new configuration.</p>
<pre class="highlight"><code class="language-shell">$ nginx -s reload</code></pre>
</div>
</div>
<div class="tabbed-block">
<p>You'll need to add the following <code>VirtualHost</code> block to your default Apache configuration or, edit the one that corresponds with your server's domain name if you're on a server, replacing all <code>&lt;placeholder&gt;</code> values with your corresponding values, the file can be created or edited if exists in <code>/etc/httpd/conf.d</code> directory:</p>
<pre class="highlight"><code class="language-apache">&lt;VirtualHost *:80&gt;      # Remove this block on Production server for security.
    ServerName &lt;your_domain_name&gt;
    DocumentRoot &lt;aboslute_path_to_project&gt;/public

    &lt;Location "/app/&lt;app_key_in_env_file&gt;"&gt;
        ProxyRequests on
        RequestHeader set X-Forwarded-Proto "http"
        ProxyPass / https://127.0.0.1:6001/
        ProxyPassReverse / https://127.0.0.1:6001/

        RewriteEngine on
        RewriteCond %{HTTP:UPGRADE} ^WebSocket$ [NC]
        RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
        RewriteRule .* ws://127.0.0.1:6001%{REQUEST_URI} [P]
    &lt;/Location&gt;
&lt;/VirtualHost&gt;

&lt;VirtualHost *:443&gt;
    ServerName &lt;your_domain_name&gt;
    DocumentRoot &lt;aboslute_path_to_project&gt;/public
    SSLEngine on
    SSLCertificateFile /etc/apache2/ssl/certificate.pem
    SSLCertificateKeyFile /etc/apache2/ssl/key.pem

    &lt;Location "/app/&lt;app_key_in_env_file&gt;"&gt;
        ProxyRequests on
        RequestHeader set X-Forwarded-Proto "http"
        ProxyPass / https://127.0.0.1:6001/
        ProxyPassReverse / https://127.0.0.1:6001/

        RewriteEngine on
        RewriteCond %{HTTP:UPGRADE} ^WebSocket$ [NC]
        RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
        RewriteRule .* ws://127.0.0.1:6001%{REQUEST_URI} [P]
    &lt;/Location&gt;
&lt;/VirtualHost&gt;</code></pre>
<div class="admonition info">
<p class="admonition-title">Notice</p>
<p>If you have changed the default websocket port with <code>LARAVEL_WEBSOCKETS_PORT</code> variable in the <code>.env</code> file, please replace the port <code>6001</code> in the apache configuration above with the one you specified in the <code>.env</code> file accordingly.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">IMPORTANT</p>
<p>After saving the file you'll need to run the following command in terminal to use the new configuration.</p>
<pre class="highlight"><code class="language-shell">$ systemctl restart httpd</code></pre>
<p>If that didn't work due to a <code>command not found</code> error, you can write:</p>
<pre class="highlight"><code class="language-shell">$ service httpd restart</code></pre>
</div>
</div>
</div>
</div>
<!-- END INCLUDE -->

<h2 id="6-were-done-whats-next">6. We're Done. What's Next!</h2>
<p>Based on your <code>prefix</code> setting in the <code>config/web-call-center.php</code> config file, if it's not set <code>null</code> then you can access the <strong>customer</strong> and the <strong>agent</strong> dashboards on <code>https://&lt;your_domain&gt;/&lt;prefix&gt;/customer</code> and, <code>https://&lt;your_domain&gt;/&lt;prefix&gt;/agent</code> respectively, replacing <code>&lt;your_domain</code>&gt; with the domain name that's configured to access your project and, <code>&lt;prefix&gt;</code> with the value of the <code>prefix</code> setting in the mentioned configuration file. If it's set to <code>null</code> simply omit the <code>&lt;prefix&gt;/</code> part from the said URLs.</p>
<div class="admonition note">
<p class="admonition-title">Notice</p>
<p>Please note that authentication middleware will be applied so, you'll be prompted to login using a <strong>customer</strong> or an <strong>agent</strong> account before you can proceed to the requested dashboard.</p>
</div>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../bare-project/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Bare Project" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Bare Project
            </div>
          </div>
        </a>
      
      
        
        <a href="../../third-parties/agora/" class="md-footer__link md-footer__link--next" aria-label="Next: Agora" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Agora
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 Mohyaddin Saleh
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://twitter.com/theultragrey" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.linkedin.com/in/theultragrey" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/grey-dev-0" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "navigation.expand", "search.highlight"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="../../highlight.min.js"></script>
      
        <script src="../../highlight.js"></script>
      
    
  </body>
</html>